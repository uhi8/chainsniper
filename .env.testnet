# Unichain Sniper Hook - Testnet Configuration
# Environment variables for testnet deployment and testing

# ==============================================================================
# NETWORK CONFIGURATIONS
# ==============================================================================

# Ethereum Sepolia L1 Configuration
ETH_RPC_URL=https://sepolia.infura.io/v3/YOUR_PROJECT_ID
L1_CHAIN_ID=11155111
L1_BLOCK_EXPLORER=https://sepolia.etherscan.io

# Optimism Sepolia L2 Configuration  
OPTIMISM_RPC_URL=https://sepolia.optimism.io
L2_CHAIN_ID=11155420
L2_BLOCK_EXPLORER=https://sepolia-optimism.etherscan.io

# Reactive Network Lasna Testnet Configuration (Phase 3)
REACTIVE_RPC_URL=https://rpc-dev.reactive.network
REACTIVE_CHAIN_ID=5567
REACTIVE_BLOCK_EXPLORER=https://testnet.reactscan.net

# ==============================================================================
# DEPLOYED CONTRACT ADDRESSES (Update after deployment)
# ==============================================================================

# L1 Contract Addresses (Ethereum Sepolia)
L1_AUTOMATION_ADDRESS=0x0000000000000000000000000000000000000000
L1_BRIDGE_MESSENGER_ADDRESS=0x0000000000000000000000000000000000000000
L1_PRICE_FEED_ADDRESS=0x694AA1769357215DE4FAC081bf1f309aDC325306

# L2 Contract Addresses (Optimism Sepolia)  
L2_SNIPER_HOOK_ADDRESS=0x0000000000000000000000000000000000000000
L2_MESSENGER_ADDRESS=0x0000000000000000000000000000000000000000
L2_POOL_MANAGER_ADDRESS=0x0000000000000000000000000000000000000000

# Reactive Network Contract Addresses (Lasna Testnet - Phase 3)
REACTIVE_L1_AUTOMATION_ADDRESS=0x0000000000000000000000000000000000000000
REACTIVE_L2_HOOK_ADDRESS=0x0000000000000000000000000000000000000000
REACTIVE_SYSTEM_CONTRACT=0x0000000000000000000000000000000000fffFfF  # System contract for payments
REACTIVE_SUBSCRIPTION_SERVICE=0x0000000000000000000000000000000000ffff01  # Subscription service

# ==============================================================================
# PROTOCOL CONFIGURATION
# ==============================================================================

# Price Feed Settings
MAX_PRICE_STALENESS=3600                    # 1 hour in seconds
PRICE_FEED_DECIMALS=8                      # Chainlink standard

# Pool Configuration
POOL_FEE=3000                              # 0.3% fee tier
TICK_SPACING=60                            # Standard for 0.3% pools
MIN_AMOUNT_IN=1000000000000000             # 0.001 ETH minimum

# Cross-Chain Settings
L1_TO_L2_GAS_LIMIT=200000                  # Gas limit for L1→L2 messages
L2_TO_L1_GAS_LIMIT=100000                  # Gas limit for L2→L1 messages
CROSS_CHAIN_MESSAGE_FEE=1000000000000000   # 0.001 ETH for message fees

# Reactive Network Settings (Phase 3)
REACTIVE_CALLBACK_GAS_LIMIT=200000         # Gas limit for react() callbacks
REACTIVE_CRON_EVENT_TYPE=10                # Cron10 = ~1 minute interval
REACTIVE_SUBSCRIPTION_FEE=1000000000000000 # Subscription fee per event in wei
REACTIVE_DEPOSIT_AMOUNT=10000000000000000  # Initial deposit: 0.01 ETH

# ==============================================================================
# TOKEN ADDRESSES
# ==============================================================================

# Ethereum Sepolia L1 Tokens
L1_WETH_ADDRESS=0xfFf9976782d46CC05630D1f6eBAb18b2324d6B14
L1_USDC_ADDRESS=0x1c7D4B196Cb0C7B01d743Fbc6116a902379C7238

# Optimism Sepolia L2 Tokens
L2_WETH_ADDRESS=0x4200000000000000000000000000000000000006
L2_USDC_ADDRESS=0x7E07E15D2a87A24492740D16f5bdF58c16db0c4E

# ==============================================================================
# BRIDGE INFRASTRUCTURE ADDRESSES
# ==============================================================================

# Optimism Bridge Contracts
L1_CROSS_DOMAIN_MESSENGER=0x58Cc85b8D04EA49cC6DBd3CbFFd00B4B8D6cb3ef
L2_CROSS_DOMAIN_MESSENGER=0x4200000000000000000000000000000000000007

# Portal Contracts
L1_OPTIMISM_PORTAL=0x16Fc5058F25648194471939df75CF27A2fdC48BC
L2_TO_L1_MESSAGE_PASSER=0x4200000000000000000000000000000000000016

# ==============================================================================
# DEVELOPMENT SETTINGS
# ==============================================================================

# Private Keys (DO NOT USE IN PRODUCTION)
DEPLOYER_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000001
TESTER_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000002

# Test Account Addresses
DEPLOYER_ADDRESS=0x7E5F4552091A69125d5DfCb7b8C2659029395Bdf
TESTER_ADDRESS=0x2B5AD5c4795c026514f8317c7a215E218DcCD6cF

# ==============================================================================
# TESTING PARAMETERS
# ==============================================================================

# Test Intent Configuration
TEST_AMOUNT_IN=1000000000000000000          # 1 ETH
TEST_TARGET_PRICE=200000000000               # $2000 in 8 decimals
TEST_MAX_SLIPPAGE_BPS=500                    # 5% slippage
TEST_INTENT_EXPIRY_HOURS=24                  # 24 hours

# Test Price Scenarios
TRIGGER_PRICE_ABOVE=220000000000             # $2200 - price above target
TRIGGER_PRICE_BELOW=180000000000             # $1800 - price below target
TRIGGER_PRICE_EXACT=200000000000             # $2000 - exact target price

# ==============================================================================
# MONITORING & ALERTS
# ==============================================================================

# Health Check URLs
L1_RPC_HEALTH_CHECK=${ETH_RPC_URL}
L2_RPC_HEALTH_CHECK=${OPTIMISM_RPC_URL}

# Alert Thresholds
MAX_EXECUTION_DELAY_MINUTES=10               # Alert if execution takes longer
MIN_CONTRACT_BALANCE_ETH=0.01                # Alert if contract balance low
MAX_FAILED_TRANSACTIONS_PER_HOUR=5          # Alert if too many failures

# ==============================================================================
# DEPLOYMENT CHECKLIST
# ==============================================================================

# Phase 1: L1 Deployment
# [ ] Fund deployer account with ETH
# [ ] Deploy ReactiveL1Automation
# [ ] Deploy OptimismL1Messenger  
# [ ] Configure automation with messenger
# [ ] Fund contracts for message fees
# [ ] Verify contracts on Etherscan

# Phase 2: L2 Deployment
# [ ] Fund deployer account with ETH on L2
# [ ] Deploy OptimismReactiveMessenger
# [ ] Deploy UnichainSniperHook
# [ ] Configure messenger with hook
# [ ] Fund messenger for fees
# [ ] Verify contracts on Optimism Explorer

# Phase 4: Integration
# [ ] Update L1 contracts with L2 addresses
# [ ] Update L2 contracts with L1 addresses
# [ ] Initialize Uniswap v4 pool (if needed)
# [ ] Test cross-chain messaging
# [ ] Perform end-to-end intent test

# Phase 5: Testing
# [ ] Create test intents with various parameters
# [ ] Trigger price changes and verify execution
# [ ] Test intent cancellation flow
# [ ] Verify slippage protection
# [ ] Test edge cases and error conditions

# PHASE 3: REACTIVE NETWORK DEPLOYMENT
# [ ] Install reactive-lib: forge install Reactive-Network/reactive-lib
# [ ] Update foundry.toml with reactive-lib remappings
# [ ] Compile all contracts with Reactive Network libraries
# [ ] Deploy ReactiveL1Automation to Lasna testnet
# [ ] Deploy ReactiveL2Hook to Lasna testnet
# [ ] Subscribe to price feed events from Ethereum Sepolia
# [ ] Subscribe to Cron10 periodic events
# [ ] Test react() callbacks with mock LogRecords
# [ ] Verify end-to-end price → intent → swap flow
# [ ] Monitor subscription fees and gas costs

# ==============================================================================
# USEFUL COMMANDS
# ==============================================================================

# Deploy L1 contracts
# forge script script/DeployL1TestnetContracts.s.sol:DeployL1TestnetContracts --rpc-url $ETH_RPC_URL --broadcast --verify

# Deploy L2 contracts  
# forge script script/DeployL2TestnetContracts.s.sol:DeployL2TestnetContracts --rpc-url $OPTIMISM_RPC_URL --broadcast --verify

# Phase 3: Deploy Reactive Network contracts to Lasna
# forge script script/DeployReactiveL1Automation.s.sol:DeployReactiveL1Automation --rpc-url $REACTIVE_RPC_URL --broadcast --verify
# forge script script/DeployReactiveL2Hook.s.sol:DeployReactiveL2Hook --rpc-url $REACTIVE_RPC_URL --broadcast --verify

# Run integration tests
# forge test --match-contract BridgeIntegrationTest --rpc-url $ETH_RPC_URL -vv

# Run Reactive Network tests
# forge test --match-contract ReactiveL1Automation --rpc-url $REACTIVE_RPC_URL -vv
# forge test --match-contract ReactiveL2Hook --rpc-url $REACTIVE_RPC_URL -vv

# Check L1 automation price
# forge script script/DeployL1TestnetContracts.s.sol:DeployL1TestnetContracts --sig "checkPrice(address)" $L1_AUTOMATION_ADDRESS --rpc-url $ETH_RPC_URL

# Update cross-chain addresses
# forge script script/DeployL1TestnetContracts.s.sol:DeployL1TestnetContracts --sig "updateL2Messenger(address,address,address)" $L1_AUTOMATION_ADDRESS $L1_BRIDGE_MESSENGER_ADDRESS $L2_MESSENGER_ADDRESS --rpc-url $ETH_RPC_URL --broadcast